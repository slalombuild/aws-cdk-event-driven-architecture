"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cxschema = require("@aws-cdk/cloud-assembly-schema");
const AWS = require("aws-sdk-mock");
const load_balancers_1 = require("../../lib/context-providers/load-balancers");
const mock_sdk_1 = require("../util/mock-sdk");
AWS.setSDK(require.resolve('aws-sdk'));
const mockSDK = new mock_sdk_1.MockSdkProvider();
afterEach(done => {
    AWS.restore();
    done();
});
describe('utilities', () => {
    test('describeTags yields tags by chunk', async () => {
        const resourceTags = {};
        for (const resourceArn of [...Array(100)].map((_, i) => `arn:load-balancer-${i}`)) {
            resourceTags[resourceArn] = {
                ResourceArn: resourceArn,
                Tags: [
                    { Key: 'name', Value: resourceArn },
                ],
            };
        }
        ;
        AWS.mock('ELBv2', 'describeTags', (_params, cb) => {
            expect(_params.ResourceArns.length).toBeLessThanOrEqual(20);
            cb(null, {
                TagDescriptions: _params.ResourceArns.map(resourceArn => ({
                    ResourceArn: resourceArn,
                    Tags: [
                        { Key: 'name', Value: resourceArn },
                    ],
                })),
            });
        });
        const elbv2 = (await mockSDK.forEnvironment()).sdk.elbv2();
        const resourceTagsOut = {};
        for await (const tagDescription of load_balancers_1.describeTags(elbv2, Object.keys(resourceTags))) {
            resourceTagsOut[tagDescription.ResourceArn] = tagDescription;
        }
        expect(resourceTagsOut).toEqual(resourceTags);
    });
    test('describeListenersByLoadBalancerArn traverses pages', async () => {
        // arn:listener-0, arn:listener-1, ..., arn:listener-99
        const listenerArns = [...Array(100)].map((_, i) => `arn:listener-${i}`);
        expect(listenerArns[0]).toEqual('arn:listener-0');
        AWS.mock('ELBv2', 'describeListeners', (_params, cb) => {
            const start = parseInt(_params.Marker ?? '0');
            const end = start + 10;
            const slice = listenerArns.slice(start, end);
            cb(null, {
                Listeners: slice.map(arn => ({
                    ListenerArn: arn,
                })),
                NextMarker: end < listenerArns.length ? end.toString() : undefined,
            });
        });
        const elbv2 = (await mockSDK.forEnvironment()).sdk.elbv2();
        const listenerArnsFromPages = Array();
        for await (const listener of load_balancers_1.describeListenersByLoadBalancerArn(elbv2, ['arn:load-balancer'])) {
            listenerArnsFromPages.push(listener.ListenerArn);
        }
        expect(listenerArnsFromPages).toEqual(listenerArns);
    });
    test('describeLoadBalancers traverses pages', async () => {
        const loadBalancerArns = [...Array(100)].map((_, i) => `arn:load-balancer-${i}`);
        expect(loadBalancerArns[0]).toEqual('arn:load-balancer-0');
        AWS.mock('ELBv2', 'describeLoadBalancers', (_params, cb) => {
            const start = parseInt(_params.Marker ?? '0');
            const end = start + 10;
            const slice = loadBalancerArns.slice(start, end);
            cb(null, {
                LoadBalancers: slice.map(loadBalancerArn => ({
                    LoadBalancerArn: loadBalancerArn,
                })),
                NextMarker: end < loadBalancerArns.length ? end.toString() : undefined,
            });
        });
        const elbv2 = (await mockSDK.forEnvironment()).sdk.elbv2();
        const loadBalancerArnsFromPages = (await load_balancers_1.describeLoadBalancers(elbv2, {})).map(l => l.LoadBalancerArn);
        expect(loadBalancerArnsFromPages).toEqual(loadBalancerArns);
    });
    describe('tagsMatch', () => {
        test('all tags match', () => {
            const tagDescription = {
                ResourceArn: 'arn:whatever',
                Tags: [{ Key: 'some', Value: 'tag' }],
            };
            const requiredTags = [
                { key: 'some', value: 'tag' },
            ];
            expect(load_balancers_1.tagsMatch(tagDescription, requiredTags)).toEqual(true);
        });
        test('extra tags match', () => {
            const tagDescription = {
                ResourceArn: 'arn:whatever',
                Tags: [
                    { Key: 'some', Value: 'tag' },
                    { Key: 'other', Value: 'tag2' },
                ],
            };
            const requiredTags = [
                { key: 'some', value: 'tag' },
            ];
            expect(load_balancers_1.tagsMatch(tagDescription, requiredTags)).toEqual(true);
        });
        test('no tags matches no tags', () => {
            const tagDescription = {
                ResourceArn: 'arn:whatever',
                Tags: [],
            };
            expect(load_balancers_1.tagsMatch(tagDescription, [])).toEqual(true);
        });
        test('one tag matches of several', () => {
            const tagDescription = {
                ResourceArn: 'arn:whatever',
                Tags: [{ Key: 'some', Value: 'tag' }],
            };
            const requiredTags = [
                { key: 'some', value: 'tag' },
                { key: 'other', value: 'value' },
            ];
            expect(load_balancers_1.tagsMatch(tagDescription, requiredTags)).toEqual(false);
        });
        test('undefined tag does not error', () => {
            const tagDescription = {
                ResourceArn: 'arn:whatever',
                Tags: [{ Key: 'some' }],
            };
            const requiredTags = [
                { key: 'some', value: 'tag' },
                { key: 'other', value: 'value' },
            ];
            expect(load_balancers_1.tagsMatch(tagDescription, requiredTags)).toEqual(false);
        });
    });
});
describe('load balancer context provider plugin', () => {
    test('errors when no matches are found', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerArn: 'arn:load-balancer1',
        })).rejects.toThrow(/No load balancers found/i);
    });
    test('errors when multiple load balancers match', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [
                {
                    IpAddressType: 'ipv4',
                    LoadBalancerArn: 'arn:load-balancer1',
                    DNSName: 'dns1.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                    Type: 'application',
                },
                {
                    IpAddressType: 'ipv4',
                    LoadBalancerArn: 'arn:load-balancer2',
                    DNSName: 'dns2.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                    Type: 'application',
                },
            ],
            describeTagsExpected: { ResourceArns: ['arn:load-balancer1', 'arn:load-balancer2'] },
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer1',
                    Tags: [
                        { Key: 'some', Value: 'tag' },
                    ],
                },
                {
                    ResourceArn: 'arn:load-balancer2',
                    Tags: [
                        { Key: 'some', Value: 'tag' },
                    ],
                },
            ],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [
                { key: 'some', value: 'tag' },
            ],
        })).rejects.toThrow(/Multiple load balancers found/i);
    });
    test('looks up by arn', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeLoadBalancersExpected: { LoadBalancerArns: ['arn:load-balancer1'] },
            loadBalancers: [
                {
                    IpAddressType: 'ipv4',
                    LoadBalancerArn: 'arn:load-balancer1',
                    DNSName: 'dns.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                    Type: 'application',
                },
            ],
        });
        // WHEN
        const result = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerArn: 'arn:load-balancer1',
        });
        // THEN
        expect(result.ipAddressType).toEqual('ipv4');
        expect(result.loadBalancerArn).toEqual('arn:load-balancer1');
        expect(result.loadBalancerCanonicalHostedZoneId).toEqual('Z1234');
        expect(result.loadBalancerDnsName).toEqual('dns.example.com');
        expect(result.securityGroupIds).toEqual(['sg-1234']);
        expect(result.vpcId).toEqual('vpc-1234');
    });
    test('looks up by tags', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [
                {
                    IpAddressType: 'ipv4',
                    LoadBalancerArn: 'arn:load-balancer1',
                    DNSName: 'dns1.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                    Type: 'application',
                },
                {
                    IpAddressType: 'ipv4',
                    LoadBalancerArn: 'arn:load-balancer2',
                    DNSName: 'dns2.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                    Type: 'application',
                },
            ],
            describeTagsExpected: { ResourceArns: ['arn:load-balancer1', 'arn:load-balancer2'] },
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer1',
                    Tags: [
                        { Key: 'some', Value: 'tag' },
                    ],
                },
                {
                    ResourceArn: 'arn:load-balancer2',
                    Tags: [
                        { Key: 'some', Value: 'tag' },
                        { Key: 'second', Value: 'tag2' },
                    ],
                },
            ],
        });
        // WHEN
        const result = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [
                { key: 'some', value: 'tag' },
                { key: 'second', value: 'tag2' },
            ],
        });
        expect(result.loadBalancerArn).toEqual('arn:load-balancer2');
    });
    test('filters by type', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [
                {
                    IpAddressType: 'ipv4',
                    Type: 'network',
                    LoadBalancerArn: 'arn:load-balancer1',
                    DNSName: 'dns1.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                },
                {
                    IpAddressType: 'ipv4',
                    Type: 'application',
                    LoadBalancerArn: 'arn:load-balancer2',
                    DNSName: 'dns2.example.com',
                    CanonicalHostedZoneId: 'Z1234',
                    SecurityGroups: ['sg-1234'],
                    VpcId: 'vpc-1234',
                },
            ],
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer1',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
                {
                    ResourceArn: 'arn:load-balancer2',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
            ],
        });
        // WHEN
        const loadBalancer = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerTags: [{ key: 'some', value: 'tag' }],
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
        });
        expect(loadBalancer.loadBalancerArn).toEqual('arn:load-balancer2');
    });
});
describe('load balancer listener context provider plugin', () => {
    test('errors when no associated load balancers match', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [{ key: 'some', value: 'tag' }],
        })).rejects.toThrow(/No associated load balancers found/i);
    });
    test('errors when no listeners match', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [
                {
                    LoadBalancerArn: 'arn:load-balancer',
                    Type: 'application',
                },
            ],
            listeners: [
                {
                    LoadBalancerArn: 'arn:load-balancer',
                    ListenerArn: 'arn:listener',
                    Port: 80,
                    Protocol: 'HTTP',
                },
            ],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerArn: 'arn:load-balancer',
            listenerPort: 443,
            listenerProtocol: cxschema.LoadBalancerListenerProtocol.HTTPS,
        })).rejects.toThrow(/No load balancer listeners found/i);
    });
    test('errors when multiple listeners match', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            loadBalancers: [
                {
                    LoadBalancerArn: 'arn:load-balancer',
                    Type: 'application',
                },
                {
                    LoadBalancerArn: 'arn:load-balancer2',
                    Type: 'application',
                },
            ],
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
                {
                    ResourceArn: 'arn:load-balancer2',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
            ],
            listeners: [
                {
                    LoadBalancerArn: 'arn:load-balancer',
                    ListenerArn: 'arn:listener',
                    Port: 80,
                    Protocol: 'HTTP',
                },
                {
                    LoadBalancerArn: 'arn:load-balancer2',
                    ListenerArn: 'arn:listener2',
                    Port: 80,
                    Protocol: 'HTTP',
                },
            ],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [{ key: 'some', value: 'tag' }],
            listenerPort: 80,
            listenerProtocol: cxschema.LoadBalancerListenerProtocol.HTTP,
        })).rejects.toThrow(/Multiple load balancer listeners/i);
    });
    test('looks up by listener arn', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeListenersExpected: { ListenerArns: ['arn:listener-arn'] },
            listeners: [
                {
                    ListenerArn: 'arn:listener-arn',
                    LoadBalancerArn: 'arn:load-balancer-arn',
                    Port: 999,
                },
            ],
            describeLoadBalancersExpected: { LoadBalancerArns: ['arn:load-balancer-arn'] },
            loadBalancers: [
                {
                    LoadBalancerArn: 'arn:load-balancer-arn',
                    SecurityGroups: ['sg-1234', 'sg-2345'],
                    Type: 'application',
                },
            ],
        });
        // WHEN
        const listener = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            listenerArn: 'arn:listener-arn',
        });
        // THEN
        expect(listener.listenerArn).toEqual('arn:listener-arn');
        expect(listener.listenerPort).toEqual(999);
        expect(listener.securityGroupIds).toEqual(['sg-1234', 'sg-2345']);
    });
    test('looks up by associated load balancer arn', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeLoadBalancersExpected: { LoadBalancerArns: ['arn:load-balancer-arn1'] },
            loadBalancers: [
                {
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    SecurityGroups: ['sg-1234'],
                    Type: 'application',
                },
            ],
            describeListenersExpected: { LoadBalancerArn: 'arn:load-balancer-arn1' },
            listeners: [
                {
                    // This one
                    ListenerArn: 'arn:listener-arn1',
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    Port: 80,
                },
            ],
        });
        // WHEN
        const listener = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerArn: 'arn:load-balancer-arn1',
        });
        // THEN
        expect(listener.listenerArn).toEqual('arn:listener-arn1');
        expect(listener.listenerPort).toEqual(80);
        expect(listener.securityGroupIds).toEqual(['sg-1234']);
    });
    test('looks up by associated load balancer tags', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeLoadBalancersExpected: { LoadBalancerArns: undefined },
            loadBalancers: [
                {
                    // This one should have the wrong tags
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    SecurityGroups: ['sg-1234', 'sg-2345'],
                    Type: 'application',
                },
                {
                    // Expecting this one
                    LoadBalancerArn: 'arn:load-balancer-arn2',
                    SecurityGroups: ['sg-3456', 'sg-4567'],
                    Type: 'application',
                },
            ],
            describeTagsExpected: { ResourceArns: ['arn:load-balancer-arn1', 'arn:load-balancer-arn2'] },
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer-arn1',
                    Tags: [],
                },
                {
                    // Expecting this one
                    ResourceArn: 'arn:load-balancer-arn2',
                    Tags: [
                        { Key: 'some', Value: 'tag' },
                    ],
                },
            ],
            describeListenersExpected: { LoadBalancerArn: 'arn:load-balancer-arn2' },
            listeners: [
                {
                    // This one
                    ListenerArn: 'arn:listener-arn1',
                    LoadBalancerArn: 'arn:load-balancer-arn2',
                    Port: 80,
                },
                {
                    ListenerArn: 'arn:listener-arn2',
                    LoadBalancerArn: 'arn:load-balancer-arn2',
                    Port: 999,
                },
            ],
        });
        // WHEN
        const listener = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [
                { key: 'some', value: 'tag' },
            ],
            listenerPort: 999,
        });
        // THEN
        expect(listener.listenerArn).toEqual('arn:listener-arn2');
        expect(listener.listenerPort).toEqual(999);
        expect(listener.securityGroupIds).toEqual(['sg-3456', 'sg-4567']);
    });
    test('looks up by listener port and proto', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        AWS.mock('ELBv2', 'describeLoadBalancers', (_params, cb) => {
            expect(_params).toEqual({});
            cb(null, {
                LoadBalancers: [
                    {
                        // Shouldn't have any matching listeners
                        IpAddressType: 'ipv4',
                        LoadBalancerArn: 'arn:load-balancer1',
                        DNSName: 'dns1.example.com',
                        CanonicalHostedZoneId: 'Z1234',
                        SecurityGroups: ['sg-1234'],
                        VpcId: 'vpc-1234',
                        Type: 'application',
                    },
                    {
                        // Should have a matching listener
                        IpAddressType: 'ipv4',
                        LoadBalancerArn: 'arn:load-balancer2',
                        DNSName: 'dns2.example.com',
                        CanonicalHostedZoneId: 'Z1234',
                        SecurityGroups: ['sg-2345'],
                        VpcId: 'vpc-1234',
                        Type: 'application',
                    },
                ],
            });
        });
        AWS.mock('ELBv2', 'describeTags', (_params, cb) => {
            cb(null, {
                TagDescriptions: [
                    {
                        ResourceArn: 'arn:load-balancer1',
                        Tags: [{ Key: 'some', Value: 'tag' }],
                    },
                    {
                        ResourceArn: 'arn:load-balancer2',
                        Tags: [{ Key: 'some', Value: 'tag' }],
                    },
                ],
            });
        });
        AWS.mock('ELBv2', 'describeListeners', (params, cb) => {
            if (params.LoadBalancerArn === 'arn:load-balancer1') {
                cb(null, {
                    Listeners: [
                        {
                            // Wrong port, wrong protocol => no match
                            ListenerArn: 'arn:listener-arn1',
                            LoadBalancerArn: 'arn:load-balancer1',
                            Protocol: 'HTTP',
                            Port: 80,
                        },
                        {
                            // Wrong protocol, right port => no match
                            ListenerArn: 'arn:listener-arn3',
                            LoadBalancerArn: 'arn:load-balancer1',
                            Protocol: 'HTTPS',
                            Port: 443,
                        },
                        {
                            // Wrong port, right protocol => no match
                            ListenerArn: 'arn:listener-arn4',
                            LoadBalancerArn: 'arn:load-balancer1',
                            Protocol: 'TCP',
                            Port: 999,
                        },
                    ],
                });
            }
            else if (params.LoadBalancerArn === 'arn:load-balancer2') {
                cb(null, {
                    Listeners: [
                        {
                            // Wrong port, wrong protocol => no match
                            ListenerArn: 'arn:listener-arn5',
                            LoadBalancerArn: 'arn:load-balancer2',
                            Protocol: 'HTTP',
                            Port: 80,
                        },
                        {
                            // Right port, right protocol => match
                            ListenerArn: 'arn:listener-arn6',
                            LoadBalancerArn: 'arn:load-balancer2',
                            Port: 443,
                            Protocol: 'TCP',
                        },
                    ],
                });
            }
            else {
                cb(new Error(`Unexpected request: ${JSON.stringify(params)}'`), {});
            }
        });
        // WHEN
        const listener = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.APPLICATION,
            loadBalancerTags: [{ key: 'some', value: 'tag' }],
            listenerProtocol: cxschema.LoadBalancerListenerProtocol.TCP,
            listenerPort: 443,
        });
        // THEN
        expect(listener.listenerArn).toEqual('arn:listener-arn6');
        expect(listener.listenerPort).toEqual(443);
        expect(listener.securityGroupIds).toEqual(['sg-2345']);
    });
    test('filters by associated load balancer type', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeLoadBalancersExpected: { LoadBalancerArns: undefined },
            loadBalancers: [
                {
                    // This one has wrong type => no match
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    SecurityGroups: [],
                    Type: 'application',
                },
                {
                    // Right type => match
                    LoadBalancerArn: 'arn:load-balancer-arn2',
                    SecurityGroups: [],
                    Type: 'network',
                },
            ],
            tagDescriptions: [
                {
                    ResourceArn: 'arn:load-balancer-arn1',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
                {
                    ResourceArn: 'arn:load-balancer-arn2',
                    Tags: [{ Key: 'some', Value: 'tag' }],
                },
            ],
            describeListenersExpected: { LoadBalancerArn: 'arn:load-balancer-arn2' },
            listeners: [
                {
                    ListenerArn: 'arn:listener-arn2',
                    LoadBalancerArn: 'arn:load-balancer-arn2',
                    Port: 443,
                },
            ],
        });
        // WHEN
        const listener = await provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.NETWORK,
            loadBalancerTags: [{ key: 'some', value: 'tag' }],
            listenerPort: 443,
        });
        // THEN
        expect(listener.listenerArn).toEqual('arn:listener-arn2');
        expect(listener.listenerPort).toEqual(443);
    });
    test('errors when associated load balancer is wrong type', async () => {
        // GIVEN
        const provider = new load_balancers_1.LoadBalancerListenerContextProviderPlugin(mockSDK);
        mockALBLookup({
            describeListenersExpected: { ListenerArns: ['arn:listener-arn1'] },
            listeners: [
                {
                    ListenerArn: 'arn:listener-arn1',
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    Port: 443,
                },
            ],
            describeLoadBalancersExpected: { LoadBalancerArns: ['arn:load-balancer-arn1'] },
            loadBalancers: [
                {
                    // This one has wrong type => no match
                    LoadBalancerArn: 'arn:load-balancer-arn1',
                    SecurityGroups: [],
                    Type: 'application',
                },
            ],
        });
        // WHEN
        await expect(provider.getValue({
            account: '1234',
            region: 'us-east-1',
            loadBalancerType: cxschema.LoadBalancerType.NETWORK,
            listenerArn: 'arn:listener-arn1',
        })).rejects.toThrow(/no associated load balancer found/i);
    });
});
function mockALBLookup(options) {
    AWS.mock('ELBv2', 'describeLoadBalancers', (_params, cb) => {
        if (options.describeLoadBalancersExpected !== undefined) {
            expect(_params).toEqual(options.describeLoadBalancersExpected);
        }
        cb(null, { LoadBalancers: options.loadBalancers });
    });
    AWS.mock('ELBv2', 'describeTags', (_params, cb) => {
        if (options.describeTagsExpected !== undefined) {
            expect(_params).toEqual(options.describeTagsExpected);
        }
        cb(null, { TagDescriptions: options.tagDescriptions });
    });
    AWS.mock('ELBv2', 'describeListeners', (_params, cb) => {
        if (options.describeListenersExpected !== undefined) {
            expect(_params).toEqual(options.describeListenersExpected);
        }
        cb(null, { Listeners: options.listeners });
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZC1iYWxhbmNlcnMudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxvYWQtYmFsYW5jZXJzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyREFBMkQ7QUFFM0Qsb0NBQW9DO0FBQ3BDLCtFQUE4TjtBQUM5TiwrQ0FBbUQ7QUFFbkQsR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFFdkMsTUFBTSxPQUFPLEdBQUcsSUFBSSwwQkFBZSxFQUFFLENBQUM7QUFJdEMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFO0lBQ2YsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2QsSUFBSSxFQUFFLENBQUM7QUFDVCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO0lBQ3pCLElBQUksQ0FBQyxtQ0FBbUMsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNuRCxNQUFNLFlBQVksR0FBNkMsRUFBRSxDQUFDO1FBQ2xFLEtBQUssTUFBTSxXQUFXLElBQUksQ0FBQyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxFQUFFO1lBQ2pGLFlBQVksQ0FBQyxXQUFXLENBQUMsR0FBRztnQkFDMUIsV0FBVyxFQUFFLFdBQVc7Z0JBQ3hCLElBQUksRUFBRTtvQkFDSixFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRTtpQkFDcEM7YUFDRixDQUFDO1NBQ0g7UUFBQSxDQUFDO1FBRUYsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsY0FBYyxFQUFFLENBQUMsT0FBb0MsRUFBRSxFQUE2QyxFQUFFLEVBQUU7WUFDeEgsTUFBTSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsTUFB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Q0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDO0lBQ3JELENBQUMsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsY0FBYyxFQUFFLENBQUMsT0FBb0MsRUFBRSxFQUE2QyxFQUFFLEVBQUU7UUFDeEgsSUFBSSxPQUFPLENBQUMsb0JBQW9CLEtBQUssU0FBUyxFQUFFO1lBQzlDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7U0FDdkQ7UUFDRCxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsZUFBZSxFQUFFLE9BQU8sQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDO0lBQ3pELENBQUMsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxPQUF5QyxFQUFFLEVBQWtELEVBQUUsRUFBRTtRQUN2SSxJQUFJLE9BQU8sQ0FBQyx5QkFBeUIsS0FBSyxTQUFTLEVBQUU7WUFDbkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMseUJBQXlCLENBQUMsQ0FBQztTQUM1RDtRQUNELEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7SUFDN0MsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY3hzY2hlbWEgZnJvbSAnQGF3cy1jZGsvY2xvdWQtYXNzZW1ibHktc2NoZW1hJztcbmltcG9ydCAqIGFzIGF3cyBmcm9tICdhd3Mtc2RrJztcbmltcG9ydCAqIGFzIEFXUyBmcm9tICdhd3Mtc2RrLW1vY2snO1xuaW1wb3J0IHsgTG9hZEJhbGFuY2VyTGlzdGVuZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4sIExvYWRCYWxhbmNlckNvbnRleHRQcm92aWRlclBsdWdpbiwgdGFnc01hdGNoLCBkZXNjcmliZUxpc3RlbmVyc0J5TG9hZEJhbGFuY2VyQXJuLCBkZXNjcmliZVRhZ3MsIGRlc2NyaWJlTG9hZEJhbGFuY2VycyB9IGZyb20gJy4uLy4uL2xpYi9jb250ZXh0LXByb3ZpZGVycy9sb2FkLWJhbGFuY2Vycyc7XG5pbXBvcnQgeyBNb2NrU2RrUHJvdmlkZXIgfSBmcm9tICcuLi91dGlsL21vY2stc2RrJztcblxuQVdTLnNldFNESyhyZXF1aXJlLnJlc29sdmUoJ2F3cy1zZGsnKSk7XG5cbmNvbnN0IG1vY2tTREsgPSBuZXcgTW9ja1Nka1Byb3ZpZGVyKCk7XG5cbnR5cGUgQXdzQ2FsbGJhY2s8VD4gPSAoZXJyOiBFcnJvciB8IG51bGwsIHZhbDogVCkgPT4gdm9pZDtcblxuYWZ0ZXJFYWNoKGRvbmUgPT4ge1xuICBBV1MucmVzdG9yZSgpO1xuICBkb25lKCk7XG59KTtcblxuZGVzY3JpYmUoJ3V0aWxpdGllcycsICgpID0+IHtcbiAgdGVzdCgnZGVzY3JpYmVUYWdzIHlpZWxkcyB0YWdzIGJ5IGNodW5rJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc291cmNlVGFnczogUmVjb3JkPHN0cmluZywgYXdzLkVMQnYyLlRhZ0Rlc2NyaXB0aW9uPiA9IHt9O1xuICAgIGZvciAoY29uc3QgcmVzb3VyY2VBcm4gb2YgWy4uLkFycmF5KDEwMCldLm1hcCgoXywgaSkgPT4gYGFybjpsb2FkLWJhbGFuY2VyLSR7aX1gKSkge1xuICAgICAgcmVzb3VyY2VUYWdzW3Jlc291cmNlQXJuXSA9IHtcbiAgICAgICAgUmVzb3VyY2VBcm46IHJlc291cmNlQXJuLFxuICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgeyBLZXk6ICduYW1lJywgVmFsdWU6IHJlc291cmNlQXJuIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgIH07XG5cbiAgICBBV1MubW9jaygnRUxCdjInLCAnZGVzY3JpYmVUYWdzJywgKF9wYXJhbXM6IGF3cy5FTEJ2Mi5EZXNjcmliZVRhZ3NJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZVRhZ3NPdXRwdXQ+KSA9PiB7XG4gICAgICBleHBlY3QoX3BhcmFtcy5SZXNvdXJjZUFybnMubGVuZ3RoKS50b0JlTGVzc1RoYW5PckVxdWFsKDIwKTtcblxuICAgICAgY2IobnVsbCwge1xuICAgICAgICBUYWdEZXNjcmlwdGlvbnM6IF9wYXJhbXMuUmVzb3VyY2VBcm5zLm1hcChyZXNvdXJjZUFybiA9PiAoe1xuICAgICAgICAgIFJlc291cmNlQXJuOiByZXNvdXJjZUFybixcbiAgICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ25hbWUnLCBWYWx1ZTogcmVzb3VyY2VBcm4gfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KSksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGVsYnYyID0gKGF3YWl0IG1vY2tTREsuZm9yRW52aXJvbm1lbnQoKSkuc2RrLmVsYnYyKCk7XG5cbiAgICBjb25zdCByZXNvdXJjZVRhZ3NPdXQ6IFJlY29yZDxzdHJpbmcsIGF3cy5FTEJ2Mi5UYWdEZXNjcmlwdGlvbj4gPSB7fTtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IHRhZ0Rlc2NyaXB0aW9uIG9mIGRlc2NyaWJlVGFncyhlbGJ2MiwgT2JqZWN0LmtleXMocmVzb3VyY2VUYWdzKSkpIHtcbiAgICAgIHJlc291cmNlVGFnc091dFt0YWdEZXNjcmlwdGlvbi5SZXNvdXJjZUFybiFdID0gdGFnRGVzY3JpcHRpb247XG4gICAgfVxuXG4gICAgZXhwZWN0KHJlc291cmNlVGFnc091dCkudG9FcXVhbChyZXNvdXJjZVRhZ3MpO1xuICB9KTtcblxuICB0ZXN0KCdkZXNjcmliZUxpc3RlbmVyc0J5TG9hZEJhbGFuY2VyQXJuIHRyYXZlcnNlcyBwYWdlcycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBhcm46bGlzdGVuZXItMCwgYXJuOmxpc3RlbmVyLTEsIC4uLiwgYXJuOmxpc3RlbmVyLTk5XG4gICAgY29uc3QgbGlzdGVuZXJBcm5zID0gWy4uLkFycmF5KDEwMCldLm1hcCgoXywgaSkgPT4gYGFybjpsaXN0ZW5lci0ke2l9YCk7XG4gICAgZXhwZWN0KGxpc3RlbmVyQXJuc1swXSkudG9FcXVhbCgnYXJuOmxpc3RlbmVyLTAnKTtcblxuICAgIEFXUy5tb2NrKCdFTEJ2MicsICdkZXNjcmliZUxpc3RlbmVycycsIChfcGFyYW1zOiBhd3MuRUxCdjIuRGVzY3JpYmVMaXN0ZW5lcnNJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZUxpc3RlbmVyc091dHB1dD4pID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VJbnQoX3BhcmFtcy5NYXJrZXIgPz8gJzAnKTtcbiAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgMTA7XG4gICAgICBjb25zdCBzbGljZSA9IGxpc3RlbmVyQXJucy5zbGljZShzdGFydCwgZW5kKTtcblxuICAgICAgY2IobnVsbCwge1xuICAgICAgICBMaXN0ZW5lcnM6IHNsaWNlLm1hcChhcm4gPT4gKHtcbiAgICAgICAgICBMaXN0ZW5lckFybjogYXJuLFxuICAgICAgICB9KSksXG4gICAgICAgIE5leHRNYXJrZXI6IGVuZCA8IGxpc3RlbmVyQXJucy5sZW5ndGggPyBlbmQudG9TdHJpbmcoKSA6IHVuZGVmaW5lZCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZWxidjIgPSAoYXdhaXQgbW9ja1NESy5mb3JFbnZpcm9ubWVudCgpKS5zZGsuZWxidjIoKTtcblxuICAgIGNvbnN0IGxpc3RlbmVyQXJuc0Zyb21QYWdlcyA9IEFycmF5PHN0cmluZz4oKTtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IGxpc3RlbmVyIG9mIGRlc2NyaWJlTGlzdGVuZXJzQnlMb2FkQmFsYW5jZXJBcm4oZWxidjIsIFsnYXJuOmxvYWQtYmFsYW5jZXInXSkpIHtcbiAgICAgIGxpc3RlbmVyQXJuc0Zyb21QYWdlcy5wdXNoKGxpc3RlbmVyLkxpc3RlbmVyQXJuISk7XG4gICAgfVxuXG4gICAgZXhwZWN0KGxpc3RlbmVyQXJuc0Zyb21QYWdlcykudG9FcXVhbChsaXN0ZW5lckFybnMpO1xuICB9KTtcblxuICB0ZXN0KCdkZXNjcmliZUxvYWRCYWxhbmNlcnMgdHJhdmVyc2VzIHBhZ2VzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGxvYWRCYWxhbmNlckFybnMgPSBbLi4uQXJyYXkoMTAwKV0ubWFwKChfLCBpKSA9PiBgYXJuOmxvYWQtYmFsYW5jZXItJHtpfWApO1xuICAgIGV4cGVjdChsb2FkQmFsYW5jZXJBcm5zWzBdKS50b0VxdWFsKCdhcm46bG9hZC1iYWxhbmNlci0wJyk7XG5cbiAgICBBV1MubW9jaygnRUxCdjInLCAnZGVzY3JpYmVMb2FkQmFsYW5jZXJzJywgKF9wYXJhbXM6IGF3cy5FTEJ2Mi5EZXNjcmliZUxvYWRCYWxhbmNlcnNJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZUxvYWRCYWxhbmNlcnNPdXRwdXQ+KSA9PiB7XG4gICAgICBjb25zdCBzdGFydCA9IHBhcnNlSW50KF9wYXJhbXMuTWFya2VyID8/ICcwJyk7XG4gICAgICBjb25zdCBlbmQgPSBzdGFydCArIDEwO1xuICAgICAgY29uc3Qgc2xpY2UgPSBsb2FkQmFsYW5jZXJBcm5zLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXG4gICAgICBjYihudWxsLCB7XG4gICAgICAgIExvYWRCYWxhbmNlcnM6IHNsaWNlLm1hcChsb2FkQmFsYW5jZXJBcm4gPT4gKHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46IGxvYWRCYWxhbmNlckFybixcbiAgICAgICAgfSkpLFxuICAgICAgICBOZXh0TWFya2VyOiBlbmQgPCBsb2FkQmFsYW5jZXJBcm5zLmxlbmd0aCA/IGVuZC50b1N0cmluZygpIDogdW5kZWZpbmVkLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBlbGJ2MiA9IChhd2FpdCBtb2NrU0RLLmZvckVudmlyb25tZW50KCkpLnNkay5lbGJ2MigpO1xuICAgIGNvbnN0IGxvYWRCYWxhbmNlckFybnNGcm9tUGFnZXMgPSAoYXdhaXQgZGVzY3JpYmVMb2FkQmFsYW5jZXJzKGVsYnYyLCB7fSkpLm1hcChsID0+IGwuTG9hZEJhbGFuY2VyQXJuISk7XG5cbiAgICBleHBlY3QobG9hZEJhbGFuY2VyQXJuc0Zyb21QYWdlcykudG9FcXVhbChsb2FkQmFsYW5jZXJBcm5zKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3RhZ3NNYXRjaCcsICgpID0+IHtcbiAgICB0ZXN0KCdhbGwgdGFncyBtYXRjaCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHRhZ0Rlc2NyaXB0aW9uID0ge1xuICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjp3aGF0ZXZlcicsXG4gICAgICAgIFRhZ3M6IFt7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfV0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXF1aXJlZFRhZ3MgPSBbXG4gICAgICAgIHsga2V5OiAnc29tZScsIHZhbHVlOiAndGFnJyB9LFxuICAgICAgXTtcblxuICAgICAgZXhwZWN0KHRhZ3NNYXRjaCh0YWdEZXNjcmlwdGlvbiwgcmVxdWlyZWRUYWdzKSkudG9FcXVhbCh0cnVlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2V4dHJhIHRhZ3MgbWF0Y2gnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0YWdEZXNjcmlwdGlvbiA9IHtcbiAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46d2hhdGV2ZXInLFxuICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH0sXG4gICAgICAgICAgeyBLZXk6ICdvdGhlcicsIFZhbHVlOiAndGFnMicgfSxcbiAgICAgICAgXSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlcXVpcmVkVGFncyA9IFtcbiAgICAgICAgeyBrZXk6ICdzb21lJywgdmFsdWU6ICd0YWcnIH0sXG4gICAgICBdO1xuXG4gICAgICBleHBlY3QodGFnc01hdGNoKHRhZ0Rlc2NyaXB0aW9uLCByZXF1aXJlZFRhZ3MpKS50b0VxdWFsKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnbm8gdGFncyBtYXRjaGVzIG5vIHRhZ3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0YWdEZXNjcmlwdGlvbiA9IHtcbiAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46d2hhdGV2ZXInLFxuICAgICAgICBUYWdzOiBbXSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdCh0YWdzTWF0Y2godGFnRGVzY3JpcHRpb24sIFtdKSkudG9FcXVhbCh0cnVlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ29uZSB0YWcgbWF0Y2hlcyBvZiBzZXZlcmFsJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGFnRGVzY3JpcHRpb24gPSB7XG4gICAgICAgIFJlc291cmNlQXJuOiAnYXJuOndoYXRldmVyJyxcbiAgICAgICAgVGFnczogW3sgS2V5OiAnc29tZScsIFZhbHVlOiAndGFnJyB9XSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlcXVpcmVkVGFncyA9IFtcbiAgICAgICAgeyBrZXk6ICdzb21lJywgdmFsdWU6ICd0YWcnIH0sXG4gICAgICAgIHsga2V5OiAnb3RoZXInLCB2YWx1ZTogJ3ZhbHVlJyB9LFxuICAgICAgXTtcblxuICAgICAgZXhwZWN0KHRhZ3NNYXRjaCh0YWdEZXNjcmlwdGlvbiwgcmVxdWlyZWRUYWdzKSkudG9FcXVhbChmYWxzZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCd1bmRlZmluZWQgdGFnIGRvZXMgbm90IGVycm9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGFnRGVzY3JpcHRpb24gPSB7XG4gICAgICAgIFJlc291cmNlQXJuOiAnYXJuOndoYXRldmVyJyxcbiAgICAgICAgVGFnczogW3sgS2V5OiAnc29tZScgfV0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXF1aXJlZFRhZ3MgPSBbXG4gICAgICAgIHsga2V5OiAnc29tZScsIHZhbHVlOiAndGFnJyB9LFxuICAgICAgICB7IGtleTogJ290aGVyJywgdmFsdWU6ICd2YWx1ZScgfSxcbiAgICAgIF07XG5cbiAgICAgIGV4cGVjdCh0YWdzTWF0Y2godGFnRGVzY3JpcHRpb24sIHJlcXVpcmVkVGFncykpLnRvRXF1YWwoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnbG9hZCBiYWxhbmNlciBjb250ZXh0IHByb3ZpZGVyIHBsdWdpbicsICgpID0+IHtcbiAgdGVzdCgnZXJyb3JzIHdoZW4gbm8gbWF0Y2hlcyBhcmUgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBMb2FkQmFsYW5jZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESyk7XG5cbiAgICBtb2NrQUxCTG9va3VwKHtcbiAgICAgIGxvYWRCYWxhbmNlcnM6IFtdLFxuICAgIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGV4cGVjdChcbiAgICAgIHByb3ZpZGVyLmdldFZhbHVlKHtcbiAgICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgICByZWdpb246ICd1cy1lYXN0LTEnLFxuICAgICAgICBsb2FkQmFsYW5jZXJUeXBlOiBjeHNjaGVtYS5Mb2FkQmFsYW5jZXJUeXBlLkFQUExJQ0FUSU9OLFxuICAgICAgICBsb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjEnLFxuICAgICAgfSksXG4gICAgKS5yZWplY3RzLnRvVGhyb3coL05vIGxvYWQgYmFsYW5jZXJzIGZvdW5kL2kpO1xuICB9KTtcblxuICB0ZXN0KCdlcnJvcnMgd2hlbiBtdWx0aXBsZSBsb2FkIGJhbGFuY2VycyBtYXRjaCcsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckNvbnRleHRQcm92aWRlclBsdWdpbihtb2NrU0RLKTtcblxuICAgIG1vY2tBTEJMb29rdXAoe1xuICAgICAgbG9hZEJhbGFuY2VyczogW1xuICAgICAgICB7XG4gICAgICAgICAgSXBBZGRyZXNzVHlwZTogJ2lwdjQnLFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMScsXG4gICAgICAgICAgRE5TTmFtZTogJ2RuczEuZXhhbXBsZS5jb20nLFxuICAgICAgICAgIENhbm9uaWNhbEhvc3RlZFpvbmVJZDogJ1oxMjM0JyxcbiAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0xMjM0J10sXG4gICAgICAgICAgVnBjSWQ6ICd2cGMtMTIzNCcsXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIElwQWRkcmVzc1R5cGU6ICdpcHY0JyxcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgIEROU05hbWU6ICdkbnMyLmV4YW1wbGUuY29tJyxcbiAgICAgICAgICBDYW5vbmljYWxIb3N0ZWRab25lSWQ6ICdaMTIzNCcsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFsnc2ctMTIzNCddLFxuICAgICAgICAgIFZwY0lkOiAndnBjLTEyMzQnLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgZGVzY3JpYmVUYWdzRXhwZWN0ZWQ6IHsgUmVzb3VyY2VBcm5zOiBbJ2Fybjpsb2FkLWJhbGFuY2VyMScsICdhcm46bG9hZC1iYWxhbmNlcjInXSB9LFxuICAgICAgdGFnRGVzY3JpcHRpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMScsXG4gICAgICAgICAgVGFnczogW1xuICAgICAgICAgICAgeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIFJlc291cmNlQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIyJyxcbiAgICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBleHBlY3QoXG4gICAgICBwcm92aWRlci5nZXRWYWx1ZSh7XG4gICAgICAgIGFjY291bnQ6ICcxMjM0JyxcbiAgICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgICAgbG9hZEJhbGFuY2VyVHlwZTogY3hzY2hlbWEuTG9hZEJhbGFuY2VyVHlwZS5BUFBMSUNBVElPTixcbiAgICAgICAgbG9hZEJhbGFuY2VyVGFnczogW1xuICAgICAgICAgIHsga2V5OiAnc29tZScsIHZhbHVlOiAndGFnJyB9LFxuICAgICAgICBdLFxuICAgICAgfSksXG4gICAgKS5yZWplY3RzLnRvVGhyb3coL011bHRpcGxlIGxvYWQgYmFsYW5jZXJzIGZvdW5kL2kpO1xuICB9KTtcblxuICB0ZXN0KCdsb29rcyB1cCBieSBhcm4nLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBMb2FkQmFsYW5jZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESyk7XG5cbiAgICBtb2NrQUxCTG9va3VwKHtcbiAgICAgIGRlc2NyaWJlTG9hZEJhbGFuY2Vyc0V4cGVjdGVkOiB7IExvYWRCYWxhbmNlckFybnM6IFsnYXJuOmxvYWQtYmFsYW5jZXIxJ10gfSxcbiAgICAgIGxvYWRCYWxhbmNlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIElwQWRkcmVzc1R5cGU6ICdpcHY0JyxcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjEnLFxuICAgICAgICAgIEROU05hbWU6ICdkbnMuZXhhbXBsZS5jb20nLFxuICAgICAgICAgIENhbm9uaWNhbEhvc3RlZFpvbmVJZDogJ1oxMjM0JyxcbiAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0xMjM0J10sXG4gICAgICAgICAgVnBjSWQ6ICd2cGMtMTIzNCcsXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgIGxvYWRCYWxhbmNlclR5cGU6IGN4c2NoZW1hLkxvYWRCYWxhbmNlclR5cGUuQVBQTElDQVRJT04sXG4gICAgICBsb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjEnLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChyZXN1bHQuaXBBZGRyZXNzVHlwZSkudG9FcXVhbCgnaXB2NCcpO1xuICAgIGV4cGVjdChyZXN1bHQubG9hZEJhbGFuY2VyQXJuKS50b0VxdWFsKCdhcm46bG9hZC1iYWxhbmNlcjEnKTtcbiAgICBleHBlY3QocmVzdWx0LmxvYWRCYWxhbmNlckNhbm9uaWNhbEhvc3RlZFpvbmVJZCkudG9FcXVhbCgnWjEyMzQnKTtcbiAgICBleHBlY3QocmVzdWx0LmxvYWRCYWxhbmNlckRuc05hbWUpLnRvRXF1YWwoJ2Rucy5leGFtcGxlLmNvbScpO1xuICAgIGV4cGVjdChyZXN1bHQuc2VjdXJpdHlHcm91cElkcykudG9FcXVhbChbJ3NnLTEyMzQnXSk7XG4gICAgZXhwZWN0KHJlc3VsdC52cGNJZCkudG9FcXVhbCgndnBjLTEyMzQnKTtcbiAgfSk7XG5cbiAgdGVzdCgnbG9va3MgdXAgYnkgdGFncycsIGFzeW5jKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTG9hZEJhbGFuY2VyQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspO1xuXG4gICAgbW9ja0FMQkxvb2t1cCh7XG4gICAgICBsb2FkQmFsYW5jZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBJcEFkZHJlc3NUeXBlOiAnaXB2NCcsXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIxJyxcbiAgICAgICAgICBETlNOYW1lOiAnZG5zMS5leGFtcGxlLmNvbScsXG4gICAgICAgICAgQ2Fub25pY2FsSG9zdGVkWm9uZUlkOiAnWjEyMzQnLFxuICAgICAgICAgIFNlY3VyaXR5R3JvdXBzOiBbJ3NnLTEyMzQnXSxcbiAgICAgICAgICBWcGNJZDogJ3ZwYy0xMjM0JyxcbiAgICAgICAgICBUeXBlOiAnYXBwbGljYXRpb24nLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgSXBBZGRyZXNzVHlwZTogJ2lwdjQnLFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMicsXG4gICAgICAgICAgRE5TTmFtZTogJ2RuczIuZXhhbXBsZS5jb20nLFxuICAgICAgICAgIENhbm9uaWNhbEhvc3RlZFpvbmVJZDogJ1oxMjM0JyxcbiAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0xMjM0J10sXG4gICAgICAgICAgVnBjSWQ6ICd2cGMtMTIzNCcsXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBkZXNjcmliZVRhZ3NFeHBlY3RlZDogeyBSZXNvdXJjZUFybnM6IFsnYXJuOmxvYWQtYmFsYW5jZXIxJywgJ2Fybjpsb2FkLWJhbGFuY2VyMiddIH0sXG4gICAgICB0YWdEZXNjcmlwdGlvbnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIFJlc291cmNlQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIxJyxcbiAgICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgIFRhZ3M6IFtcbiAgICAgICAgICAgIHsgS2V5OiAnc29tZScsIFZhbHVlOiAndGFnJyB9LFxuICAgICAgICAgICAgeyBLZXk6ICdzZWNvbmQnLCBWYWx1ZTogJ3RhZzInIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgIGxvYWRCYWxhbmNlclR5cGU6IGN4c2NoZW1hLkxvYWRCYWxhbmNlclR5cGUuQVBQTElDQVRJT04sXG4gICAgICBsb2FkQmFsYW5jZXJUYWdzOiBbXG4gICAgICAgIHsga2V5OiAnc29tZScsIHZhbHVlOiAndGFnJyB9LFxuICAgICAgICB7IGtleTogJ3NlY29uZCcsIHZhbHVlOiAndGFnMicgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBleHBlY3QocmVzdWx0LmxvYWRCYWxhbmNlckFybikudG9FcXVhbCgnYXJuOmxvYWQtYmFsYW5jZXIyJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2ZpbHRlcnMgYnkgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckNvbnRleHRQcm92aWRlclBsdWdpbihtb2NrU0RLKTtcblxuICAgIG1vY2tBTEJMb29rdXAoe1xuICAgICAgbG9hZEJhbGFuY2VyczogW1xuICAgICAgICB7XG4gICAgICAgICAgSXBBZGRyZXNzVHlwZTogJ2lwdjQnLFxuICAgICAgICAgIFR5cGU6ICduZXR3b3JrJyxcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjEnLFxuICAgICAgICAgIEROU05hbWU6ICdkbnMxLmV4YW1wbGUuY29tJyxcbiAgICAgICAgICBDYW5vbmljYWxIb3N0ZWRab25lSWQ6ICdaMTIzNCcsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFsnc2ctMTIzNCddLFxuICAgICAgICAgIFZwY0lkOiAndnBjLTEyMzQnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgSXBBZGRyZXNzVHlwZTogJ2lwdjQnLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIyJyxcbiAgICAgICAgICBETlNOYW1lOiAnZG5zMi5leGFtcGxlLmNvbScsXG4gICAgICAgICAgQ2Fub25pY2FsSG9zdGVkWm9uZUlkOiAnWjEyMzQnLFxuICAgICAgICAgIFNlY3VyaXR5R3JvdXBzOiBbJ3NnLTEyMzQnXSxcbiAgICAgICAgICBWcGNJZDogJ3ZwYy0xMjM0JyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG5cbiAgICAgIHRhZ0Rlc2NyaXB0aW9uczogW1xuICAgICAgICB7XG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlcjEnLFxuICAgICAgICAgIFRhZ3M6IFt7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfV0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMicsXG4gICAgICAgICAgVGFnczogW3sgS2V5OiAnc29tZScsIFZhbHVlOiAndGFnJyB9XSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbG9hZEJhbGFuY2VyID0gYXdhaXQgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgIGxvYWRCYWxhbmNlclRhZ3M6IFt7IGtleTogJ3NvbWUnLCB2YWx1ZTogJ3RhZycgfV0sXG4gICAgICBsb2FkQmFsYW5jZXJUeXBlOiBjeHNjaGVtYS5Mb2FkQmFsYW5jZXJUeXBlLkFQUExJQ0FUSU9OLFxuICAgIH0pO1xuXG4gICAgZXhwZWN0KGxvYWRCYWxhbmNlci5sb2FkQmFsYW5jZXJBcm4pLnRvRXF1YWwoJ2Fybjpsb2FkLWJhbGFuY2VyMicpO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnbG9hZCBiYWxhbmNlciBsaXN0ZW5lciBjb250ZXh0IHByb3ZpZGVyIHBsdWdpbicsICgpID0+IHtcbiAgdGVzdCgnZXJyb3JzIHdoZW4gbm8gYXNzb2NpYXRlZCBsb2FkIGJhbGFuY2VycyBtYXRjaCcsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckxpc3RlbmVyQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspO1xuXG4gICAgbW9ja0FMQkxvb2t1cCh7XG4gICAgICBsb2FkQmFsYW5jZXJzOiBbXSxcbiAgICB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBleHBlY3QoXG4gICAgICBwcm92aWRlci5nZXRWYWx1ZSh7XG4gICAgICAgIGFjY291bnQ6ICcxMjM0JyxcbiAgICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgICAgbG9hZEJhbGFuY2VyVHlwZTogY3hzY2hlbWEuTG9hZEJhbGFuY2VyVHlwZS5BUFBMSUNBVElPTixcbiAgICAgICAgbG9hZEJhbGFuY2VyVGFnczogW3sga2V5OiAnc29tZScsIHZhbHVlOiAndGFnJyB9XSxcbiAgICAgIH0pLFxuICAgICkucmVqZWN0cy50b1Rocm93KC9ObyBhc3NvY2lhdGVkIGxvYWQgYmFsYW5jZXJzIGZvdW5kL2kpO1xuICB9KTtcblxuICB0ZXN0KCdlcnJvcnMgd2hlbiBubyBsaXN0ZW5lcnMgbWF0Y2gnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBMb2FkQmFsYW5jZXJMaXN0ZW5lckNvbnRleHRQcm92aWRlclBsdWdpbihtb2NrU0RLKTtcblxuICAgIG1vY2tBTEJMb29rdXAoe1xuICAgICAgbG9hZEJhbGFuY2VyczogW1xuICAgICAgICB7XG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXInLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgbGlzdGVuZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcicsXG4gICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXInLFxuICAgICAgICAgIFBvcnQ6IDgwLFxuICAgICAgICAgIFByb3RvY29sOiAnSFRUUCcsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGV4cGVjdChcbiAgICAgIHByb3ZpZGVyLmdldFZhbHVlKHtcbiAgICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgICByZWdpb246ICd1cy1lYXN0LTEnLFxuICAgICAgICBsb2FkQmFsYW5jZXJUeXBlOiBjeHNjaGVtYS5Mb2FkQmFsYW5jZXJUeXBlLkFQUExJQ0FUSU9OLFxuICAgICAgICBsb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcicsXG4gICAgICAgIGxpc3RlbmVyUG9ydDogNDQzLFxuICAgICAgICBsaXN0ZW5lclByb3RvY29sOiBjeHNjaGVtYS5Mb2FkQmFsYW5jZXJMaXN0ZW5lclByb3RvY29sLkhUVFBTLFxuICAgICAgfSksXG4gICAgKS5yZWplY3RzLnRvVGhyb3coL05vIGxvYWQgYmFsYW5jZXIgbGlzdGVuZXJzIGZvdW5kL2kpO1xuICB9KTtcblxuICB0ZXN0KCdlcnJvcnMgd2hlbiBtdWx0aXBsZSBsaXN0ZW5lcnMgbWF0Y2gnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBMb2FkQmFsYW5jZXJMaXN0ZW5lckNvbnRleHRQcm92aWRlclBsdWdpbihtb2NrU0RLKTtcblxuICAgIG1vY2tBTEJMb29rdXAoe1xuICAgICAgbG9hZEJhbGFuY2VyczogW1xuICAgICAgICB7XG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXInLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgdGFnRGVzY3JpcHRpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjpsb2FkLWJhbGFuY2VyJyxcbiAgICAgICAgICBUYWdzOiBbeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH1dLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgIFRhZ3M6IFt7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfV0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgbGlzdGVuZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcicsXG4gICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXInLFxuICAgICAgICAgIFBvcnQ6IDgwLFxuICAgICAgICAgIFByb3RvY29sOiAnSFRUUCcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgIExpc3RlbmVyQXJuOiAnYXJuOmxpc3RlbmVyMicsXG4gICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgUHJvdG9jb2w6ICdIVFRQJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgZXhwZWN0KFxuICAgICAgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgICBhY2NvdW50OiAnMTIzNCcsXG4gICAgICAgIHJlZ2lvbjogJ3VzLWVhc3QtMScsXG4gICAgICAgIGxvYWRCYWxhbmNlclR5cGU6IGN4c2NoZW1hLkxvYWRCYWxhbmNlclR5cGUuQVBQTElDQVRJT04sXG4gICAgICAgIGxvYWRCYWxhbmNlclRhZ3M6IFt7IGtleTogJ3NvbWUnLCB2YWx1ZTogJ3RhZycgfV0sXG4gICAgICAgIGxpc3RlbmVyUG9ydDogODAsXG4gICAgICAgIGxpc3RlbmVyUHJvdG9jb2w6IGN4c2NoZW1hLkxvYWRCYWxhbmNlckxpc3RlbmVyUHJvdG9jb2wuSFRUUCxcbiAgICAgIH0pLFxuICAgICkucmVqZWN0cy50b1Rocm93KC9NdWx0aXBsZSBsb2FkIGJhbGFuY2VyIGxpc3RlbmVycy9pKTtcbiAgfSk7XG5cbiAgdGVzdCgnbG9va3MgdXAgYnkgbGlzdGVuZXIgYXJuJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTG9hZEJhbGFuY2VyTGlzdGVuZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESyk7XG5cbiAgICBtb2NrQUxCTG9va3VwKHtcbiAgICAgIGRlc2NyaWJlTGlzdGVuZXJzRXhwZWN0ZWQ6IHsgTGlzdGVuZXJBcm5zOiBbJ2FybjpsaXN0ZW5lci1hcm4nXSB9LFxuICAgICAgbGlzdGVuZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMaXN0ZW5lckFybjogJ2FybjpsaXN0ZW5lci1hcm4nLFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybicsXG4gICAgICAgICAgUG9ydDogOTk5LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIGRlc2NyaWJlTG9hZEJhbGFuY2Vyc0V4cGVjdGVkOiB7IExvYWRCYWxhbmNlckFybnM6IFsnYXJuOmxvYWQtYmFsYW5jZXItYXJuJ10gfSxcbiAgICAgIGxvYWRCYWxhbmNlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybicsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFsnc2ctMTIzNCcsICdzZy0yMzQ1J10sXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbGlzdGVuZXIgPSBhd2FpdCBwcm92aWRlci5nZXRWYWx1ZSh7XG4gICAgICBhY2NvdW50OiAnMTIzNCcsXG4gICAgICByZWdpb246ICd1cy1lYXN0LTEnLFxuICAgICAgbG9hZEJhbGFuY2VyVHlwZTogY3hzY2hlbWEuTG9hZEJhbGFuY2VyVHlwZS5BUFBMSUNBVElPTixcbiAgICAgIGxpc3RlbmVyQXJuOiAnYXJuOmxpc3RlbmVyLWFybicsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGxpc3RlbmVyLmxpc3RlbmVyQXJuKS50b0VxdWFsKCdhcm46bGlzdGVuZXItYXJuJyk7XG4gICAgZXhwZWN0KGxpc3RlbmVyLmxpc3RlbmVyUG9ydCkudG9FcXVhbCg5OTkpO1xuICAgIGV4cGVjdChsaXN0ZW5lci5zZWN1cml0eUdyb3VwSWRzKS50b0VxdWFsKFsnc2ctMTIzNCcsICdzZy0yMzQ1J10pO1xuICB9KTtcblxuICB0ZXN0KCdsb29rcyB1cCBieSBhc3NvY2lhdGVkIGxvYWQgYmFsYW5jZXIgYXJuJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTG9hZEJhbGFuY2VyTGlzdGVuZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESyk7XG5cbiAgICBtb2NrQUxCTG9va3VwKHtcbiAgICAgIGRlc2NyaWJlTG9hZEJhbGFuY2Vyc0V4cGVjdGVkOiB7IExvYWRCYWxhbmNlckFybnM6IFsnYXJuOmxvYWQtYmFsYW5jZXItYXJuMSddIH0sXG4gICAgICBsb2FkQmFsYW5jZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4xJyxcbiAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0xMjM0J10sXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG5cbiAgICAgIGRlc2NyaWJlTGlzdGVuZXJzRXhwZWN0ZWQ6IHsgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXItYXJuMScgfSxcbiAgICAgIGxpc3RlbmVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgLy8gVGhpcyBvbmVcbiAgICAgICAgICBMaXN0ZW5lckFybjogJ2FybjpsaXN0ZW5lci1hcm4xJyxcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4xJyxcbiAgICAgICAgICBQb3J0OiA4MCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbGlzdGVuZXIgPSBhd2FpdCBwcm92aWRlci5nZXRWYWx1ZSh7XG4gICAgICBhY2NvdW50OiAnMTIzNCcsXG4gICAgICByZWdpb246ICd1cy1lYXN0LTEnLFxuICAgICAgbG9hZEJhbGFuY2VyVHlwZTogY3hzY2hlbWEuTG9hZEJhbGFuY2VyVHlwZS5BUFBMSUNBVElPTixcbiAgICAgIGxvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjEnLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChsaXN0ZW5lci5saXN0ZW5lckFybikudG9FcXVhbCgnYXJuOmxpc3RlbmVyLWFybjEnKTtcbiAgICBleHBlY3QobGlzdGVuZXIubGlzdGVuZXJQb3J0KS50b0VxdWFsKDgwKTtcbiAgICBleHBlY3QobGlzdGVuZXIuc2VjdXJpdHlHcm91cElkcykudG9FcXVhbChbJ3NnLTEyMzQnXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2xvb2tzIHVwIGJ5IGFzc29jaWF0ZWQgbG9hZCBiYWxhbmNlciB0YWdzJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTG9hZEJhbGFuY2VyTGlzdGVuZXJDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESyk7XG5cbiAgICBtb2NrQUxCTG9va3VwKHtcbiAgICAgIGRlc2NyaWJlTG9hZEJhbGFuY2Vyc0V4cGVjdGVkOiB7IExvYWRCYWxhbmNlckFybnM6IHVuZGVmaW5lZCB9LFxuICAgICAgbG9hZEJhbGFuY2VyczogW1xuICAgICAgICB7XG4gICAgICAgICAgLy8gVGhpcyBvbmUgc2hvdWxkIGhhdmUgdGhlIHdyb25nIHRhZ3NcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4xJyxcbiAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0xMjM0JywgJ3NnLTIzNDUnXSxcbiAgICAgICAgICBUeXBlOiAnYXBwbGljYXRpb24nLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgLy8gRXhwZWN0aW5nIHRoaXMgb25lXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXItYXJuMicsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFsnc2ctMzQ1NicsICdzZy00NTY3J10sXG4gICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG5cbiAgICAgIGRlc2NyaWJlVGFnc0V4cGVjdGVkOiB7IFJlc291cmNlQXJuczogWydhcm46bG9hZC1iYWxhbmNlci1hcm4xJywgJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjInXSB9LFxuICAgICAgdGFnRGVzY3JpcHRpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjEnLFxuICAgICAgICAgIFRhZ3M6IFtdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgLy8gRXhwZWN0aW5nIHRoaXMgb25lXG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4yJyxcbiAgICAgICAgICBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ3NvbWUnLCBWYWx1ZTogJ3RhZycgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSxcblxuICAgICAgZGVzY3JpYmVMaXN0ZW5lcnNFeHBlY3RlZDogeyBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4yJyB9LFxuICAgICAgbGlzdGVuZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBUaGlzIG9uZVxuICAgICAgICAgIExpc3RlbmVyQXJuOiAnYXJuOmxpc3RlbmVyLWFybjEnLFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjInLFxuICAgICAgICAgIFBvcnQ6IDgwLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXItYXJuMicsXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXItYXJuMicsXG4gICAgICAgICAgUG9ydDogOTk5LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCBsaXN0ZW5lciA9IGF3YWl0IHByb3ZpZGVyLmdldFZhbHVlKHtcbiAgICAgIGFjY291bnQ6ICcxMjM0JyxcbiAgICAgIHJlZ2lvbjogJ3VzLWVhc3QtMScsXG4gICAgICBsb2FkQmFsYW5jZXJUeXBlOiBjeHNjaGVtYS5Mb2FkQmFsYW5jZXJUeXBlLkFQUExJQ0FUSU9OLFxuICAgICAgbG9hZEJhbGFuY2VyVGFnczogW1xuICAgICAgICB7IGtleTogJ3NvbWUnLCB2YWx1ZTogJ3RhZycgfSxcbiAgICAgIF0sXG4gICAgICBsaXN0ZW5lclBvcnQ6IDk5OSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QobGlzdGVuZXIubGlzdGVuZXJBcm4pLnRvRXF1YWwoJ2FybjpsaXN0ZW5lci1hcm4yJyk7XG4gICAgZXhwZWN0KGxpc3RlbmVyLmxpc3RlbmVyUG9ydCkudG9FcXVhbCg5OTkpO1xuICAgIGV4cGVjdChsaXN0ZW5lci5zZWN1cml0eUdyb3VwSWRzKS50b0VxdWFsKFsnc2ctMzQ1NicsICdzZy00NTY3J10pO1xuICB9KTtcblxuICB0ZXN0KCdsb29rcyB1cCBieSBsaXN0ZW5lciBwb3J0IGFuZCBwcm90bycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckxpc3RlbmVyQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspO1xuXG4gICAgQVdTLm1vY2soJ0VMQnYyJywgJ2Rlc2NyaWJlTG9hZEJhbGFuY2VycycsIChfcGFyYW1zOiBhd3MuRUxCdjIuRGVzY3JpYmVMb2FkQmFsYW5jZXJzSW5wdXQsIGNiOiBBd3NDYWxsYmFjazxhd3MuRUxCdjIuRGVzY3JpYmVMb2FkQmFsYW5jZXJzT3V0cHV0PikgPT4ge1xuICAgICAgZXhwZWN0KF9wYXJhbXMpLnRvRXF1YWwoe30pO1xuICAgICAgY2IobnVsbCwge1xuICAgICAgICBMb2FkQmFsYW5jZXJzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLy8gU2hvdWxkbid0IGhhdmUgYW55IG1hdGNoaW5nIGxpc3RlbmVyc1xuICAgICAgICAgICAgSXBBZGRyZXNzVHlwZTogJ2lwdjQnLFxuICAgICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIxJyxcbiAgICAgICAgICAgIEROU05hbWU6ICdkbnMxLmV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIENhbm9uaWNhbEhvc3RlZFpvbmVJZDogJ1oxMjM0JyxcbiAgICAgICAgICAgIFNlY3VyaXR5R3JvdXBzOiBbJ3NnLTEyMzQnXSxcbiAgICAgICAgICAgIFZwY0lkOiAndnBjLTEyMzQnLFxuICAgICAgICAgICAgVHlwZTogJ2FwcGxpY2F0aW9uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIC8vIFNob3VsZCBoYXZlIGEgbWF0Y2hpbmcgbGlzdGVuZXJcbiAgICAgICAgICAgIElwQWRkcmVzc1R5cGU6ICdpcHY0JyxcbiAgICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMicsXG4gICAgICAgICAgICBETlNOYW1lOiAnZG5zMi5leGFtcGxlLmNvbScsXG4gICAgICAgICAgICBDYW5vbmljYWxIb3N0ZWRab25lSWQ6ICdaMTIzNCcsXG4gICAgICAgICAgICBTZWN1cml0eUdyb3VwczogWydzZy0yMzQ1J10sXG4gICAgICAgICAgICBWcGNJZDogJ3ZwYy0xMjM0JyxcbiAgICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgQVdTLm1vY2soJ0VMQnYyJywgJ2Rlc2NyaWJlVGFncycsIChfcGFyYW1zOiBhd3MuRUxCdjIuRGVzY3JpYmVUYWdzSW5wdXQsIGNiOiBBd3NDYWxsYmFjazxhd3MuRUxCdjIuRGVzY3JpYmVUYWdzT3V0cHV0PikgPT4ge1xuICAgICAgY2IobnVsbCwge1xuICAgICAgICBUYWdEZXNjcmlwdGlvbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZXNvdXJjZUFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMScsXG4gICAgICAgICAgICBUYWdzOiBbeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH1dLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgICAgVGFnczogW3sgS2V5OiAnc29tZScsIFZhbHVlOiAndGFnJyB9XSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBBV1MubW9jaygnRUxCdjInLCAnZGVzY3JpYmVMaXN0ZW5lcnMnLCAocGFyYW1zOiBhd3MuRUxCdjIuRGVzY3JpYmVMaXN0ZW5lcnNJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZUxpc3RlbmVyc091dHB1dD4pID0+IHtcbiAgICAgIGlmIChwYXJhbXMuTG9hZEJhbGFuY2VyQXJuID09PSAnYXJuOmxvYWQtYmFsYW5jZXIxJykge1xuICAgICAgICBjYihudWxsLCB7XG4gICAgICAgICAgTGlzdGVuZXJzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAvLyBXcm9uZyBwb3J0LCB3cm9uZyBwcm90b2NvbCA9PiBubyBtYXRjaFxuICAgICAgICAgICAgICBMaXN0ZW5lckFybjogJ2FybjpsaXN0ZW5lci1hcm4xJyxcbiAgICAgICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXIxJyxcbiAgICAgICAgICAgICAgUHJvdG9jb2w6ICdIVFRQJyxcbiAgICAgICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgLy8gV3JvbmcgcHJvdG9jb2wsIHJpZ2h0IHBvcnQgPT4gbm8gbWF0Y2hcbiAgICAgICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXItYXJuMycsXG4gICAgICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMScsXG4gICAgICAgICAgICAgIFByb3RvY29sOiAnSFRUUFMnLFxuICAgICAgICAgICAgICBQb3J0OiA0NDMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgLy8gV3JvbmcgcG9ydCwgcmlnaHQgcHJvdG9jb2wgPT4gbm8gbWF0Y2hcbiAgICAgICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXItYXJuNCcsXG4gICAgICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMScsXG4gICAgICAgICAgICAgIFByb3RvY29sOiAnVENQJyxcbiAgICAgICAgICAgICAgUG9ydDogOTk5LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAocGFyYW1zLkxvYWRCYWxhbmNlckFybiA9PT0gJ2Fybjpsb2FkLWJhbGFuY2VyMicpIHtcbiAgICAgICAgY2IobnVsbCwge1xuICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgLy8gV3JvbmcgcG9ydCwgd3JvbmcgcHJvdG9jb2wgPT4gbm8gbWF0Y2hcbiAgICAgICAgICAgICAgTGlzdGVuZXJBcm46ICdhcm46bGlzdGVuZXItYXJuNScsXG4gICAgICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyMicsXG4gICAgICAgICAgICAgIFByb3RvY29sOiAnSFRUUCcsXG4gICAgICAgICAgICAgIFBvcnQ6IDgwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgIC8vIFJpZ2h0IHBvcnQsIHJpZ2h0IHByb3RvY29sID0+IG1hdGNoXG4gICAgICAgICAgICAgIExpc3RlbmVyQXJuOiAnYXJuOmxpc3RlbmVyLWFybjYnLFxuICAgICAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlcjInLFxuICAgICAgICAgICAgICBQb3J0OiA0NDMsXG4gICAgICAgICAgICAgIFByb3RvY29sOiAnVENQJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYihuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgcmVxdWVzdDogJHtKU09OLnN0cmluZ2lmeShwYXJhbXMpfSdgKSwge30pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IGxpc3RlbmVyID0gYXdhaXQgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgIGxvYWRCYWxhbmNlclR5cGU6IGN4c2NoZW1hLkxvYWRCYWxhbmNlclR5cGUuQVBQTElDQVRJT04sXG4gICAgICBsb2FkQmFsYW5jZXJUYWdzOiBbeyBrZXk6ICdzb21lJywgdmFsdWU6ICd0YWcnIH1dLFxuICAgICAgbGlzdGVuZXJQcm90b2NvbDogY3hzY2hlbWEuTG9hZEJhbGFuY2VyTGlzdGVuZXJQcm90b2NvbC5UQ1AsXG4gICAgICBsaXN0ZW5lclBvcnQ6IDQ0MyxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QobGlzdGVuZXIubGlzdGVuZXJBcm4pLnRvRXF1YWwoJ2FybjpsaXN0ZW5lci1hcm42Jyk7XG4gICAgZXhwZWN0KGxpc3RlbmVyLmxpc3RlbmVyUG9ydCkudG9FcXVhbCg0NDMpO1xuICAgIGV4cGVjdChsaXN0ZW5lci5zZWN1cml0eUdyb3VwSWRzKS50b0VxdWFsKFsnc2ctMjM0NSddKTtcbiAgfSk7XG5cbiAgdGVzdCgnZmlsdGVycyBieSBhc3NvY2lhdGVkIGxvYWQgYmFsYW5jZXIgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckxpc3RlbmVyQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspO1xuXG4gICAgbW9ja0FMQkxvb2t1cCh7XG4gICAgICBkZXNjcmliZUxvYWRCYWxhbmNlcnNFeHBlY3RlZDogeyBMb2FkQmFsYW5jZXJBcm5zOiB1bmRlZmluZWQgfSxcbiAgICAgIGxvYWRCYWxhbmNlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIC8vIFRoaXMgb25lIGhhcyB3cm9uZyB0eXBlID0+IG5vIG1hdGNoXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXItYXJuMScsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFtdLFxuICAgICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbicsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBSaWdodCB0eXBlID0+IG1hdGNoXG4gICAgICAgICAgTG9hZEJhbGFuY2VyQXJuOiAnYXJuOmxvYWQtYmFsYW5jZXItYXJuMicsXG4gICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFtdLFxuICAgICAgICAgIFR5cGU6ICduZXR3b3JrJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG5cbiAgICAgIHRhZ0Rlc2NyaXB0aW9uczogW1xuICAgICAgICB7XG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4xJyxcbiAgICAgICAgICBUYWdzOiBbeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH1dLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgUmVzb3VyY2VBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4yJyxcbiAgICAgICAgICBUYWdzOiBbeyBLZXk6ICdzb21lJywgVmFsdWU6ICd0YWcnIH1dLFxuICAgICAgICB9LFxuICAgICAgXSxcblxuICAgICAgZGVzY3JpYmVMaXN0ZW5lcnNFeHBlY3RlZDogeyBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4yJyB9LFxuICAgICAgbGlzdGVuZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMaXN0ZW5lckFybjogJ2FybjpsaXN0ZW5lci1hcm4yJyxcbiAgICAgICAgICBMb2FkQmFsYW5jZXJBcm46ICdhcm46bG9hZC1iYWxhbmNlci1hcm4yJyxcbiAgICAgICAgICBQb3J0OiA0NDMsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IGxpc3RlbmVyID0gYXdhaXQgcHJvdmlkZXIuZ2V0VmFsdWUoe1xuICAgICAgYWNjb3VudDogJzEyMzQnLFxuICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgIGxvYWRCYWxhbmNlclR5cGU6IGN4c2NoZW1hLkxvYWRCYWxhbmNlclR5cGUuTkVUV09SSyxcbiAgICAgIGxvYWRCYWxhbmNlclRhZ3M6IFt7IGtleTogJ3NvbWUnLCB2YWx1ZTogJ3RhZycgfV0sXG4gICAgICBsaXN0ZW5lclBvcnQ6IDQ0MyxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QobGlzdGVuZXIubGlzdGVuZXJBcm4pLnRvRXF1YWwoJ2FybjpsaXN0ZW5lci1hcm4yJyk7XG4gICAgZXhwZWN0KGxpc3RlbmVyLmxpc3RlbmVyUG9ydCkudG9FcXVhbCg0NDMpO1xuICB9KTtcblxuICB0ZXN0KCdlcnJvcnMgd2hlbiBhc3NvY2lhdGVkIGxvYWQgYmFsYW5jZXIgaXMgd3JvbmcgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IExvYWRCYWxhbmNlckxpc3RlbmVyQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspO1xuXG4gICAgbW9ja0FMQkxvb2t1cCh7XG4gICAgICBkZXNjcmliZUxpc3RlbmVyc0V4cGVjdGVkOiB7IExpc3RlbmVyQXJuczogWydhcm46bGlzdGVuZXItYXJuMSddIH0sXG4gICAgICBsaXN0ZW5lcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIExpc3RlbmVyQXJuOiAnYXJuOmxpc3RlbmVyLWFybjEnLFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjEnLFxuICAgICAgICAgIFBvcnQ6IDQ0MyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG5cbiAgICAgIGRlc2NyaWJlTG9hZEJhbGFuY2Vyc0V4cGVjdGVkOiB7IExvYWRCYWxhbmNlckFybnM6IFsnYXJuOmxvYWQtYmFsYW5jZXItYXJuMSddIH0sXG4gICAgICBsb2FkQmFsYW5jZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBUaGlzIG9uZSBoYXMgd3JvbmcgdHlwZSA9PiBubyBtYXRjaFxuICAgICAgICAgIExvYWRCYWxhbmNlckFybjogJ2Fybjpsb2FkLWJhbGFuY2VyLWFybjEnLFxuICAgICAgICAgIFNlY3VyaXR5R3JvdXBzOiBbXSxcbiAgICAgICAgICBUeXBlOiAnYXBwbGljYXRpb24nLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBleHBlY3QoXG4gICAgICBwcm92aWRlci5nZXRWYWx1ZSh7XG4gICAgICAgIGFjY291bnQ6ICcxMjM0JyxcbiAgICAgICAgcmVnaW9uOiAndXMtZWFzdC0xJyxcbiAgICAgICAgbG9hZEJhbGFuY2VyVHlwZTogY3hzY2hlbWEuTG9hZEJhbGFuY2VyVHlwZS5ORVRXT1JLLFxuICAgICAgICBsaXN0ZW5lckFybjogJ2FybjpsaXN0ZW5lci1hcm4xJyxcbiAgICAgIH0pLFxuICAgICkucmVqZWN0cy50b1Rocm93KC9ubyBhc3NvY2lhdGVkIGxvYWQgYmFsYW5jZXIgZm91bmQvaSk7XG4gIH0pO1xufSk7XG5cbmludGVyZmFjZSBBTEJMb29rdXBPcHRpb25zIHtcbiAgZGVzY3JpYmVMb2FkQmFsYW5jZXJzRXhwZWN0ZWQ/OiBhbnk7XG4gIGxvYWRCYWxhbmNlcnM/OiBhd3MuRUxCdjIuTG9hZEJhbGFuY2VycztcbiAgZGVzY3JpYmVUYWdzRXhwZWN0ZWQ/OiBhbnk7XG4gIHRhZ0Rlc2NyaXB0aW9ucz86IGF3cy5FTEJ2Mi5UYWdEZXNjcmlwdGlvbnM7XG4gIGRlc2NyaWJlTGlzdGVuZXJzRXhwZWN0ZWQ/OiBhbnk7XG4gIGxpc3RlbmVycz86IGF3cy5FTEJ2Mi5MaXN0ZW5lcnM7XG59XG5cbmZ1bmN0aW9uIG1vY2tBTEJMb29rdXAob3B0aW9uczogQUxCTG9va3VwT3B0aW9ucykge1xuICBBV1MubW9jaygnRUxCdjInLCAnZGVzY3JpYmVMb2FkQmFsYW5jZXJzJywgKF9wYXJhbXM6IGF3cy5FTEJ2Mi5EZXNjcmliZUxvYWRCYWxhbmNlcnNJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZUxvYWRCYWxhbmNlcnNPdXRwdXQ+KSA9PiB7XG4gICAgaWYgKG9wdGlvbnMuZGVzY3JpYmVMb2FkQmFsYW5jZXJzRXhwZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZXhwZWN0KF9wYXJhbXMpLnRvRXF1YWwob3B0aW9ucy5kZXNjcmliZUxvYWRCYWxhbmNlcnNFeHBlY3RlZCk7XG4gICAgfVxuICAgIGNiKG51bGwsIHsgTG9hZEJhbGFuY2Vyczogb3B0aW9ucy5sb2FkQmFsYW5jZXJzIH0pO1xuICB9KTtcblxuICBBV1MubW9jaygnRUxCdjInLCAnZGVzY3JpYmVUYWdzJywgKF9wYXJhbXM6IGF3cy5FTEJ2Mi5EZXNjcmliZVRhZ3NJbnB1dCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FTEJ2Mi5EZXNjcmliZVRhZ3NPdXRwdXQ+KSA9PiB7XG4gICAgaWYgKG9wdGlvbnMuZGVzY3JpYmVUYWdzRXhwZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZXhwZWN0KF9wYXJhbXMpLnRvRXF1YWwob3B0aW9ucy5kZXNjcmliZVRhZ3NFeHBlY3RlZCk7XG4gICAgfVxuICAgIGNiKG51bGwsIHsgVGFnRGVzY3JpcHRpb25zOiBvcHRpb25zLnRhZ0Rlc2NyaXB0aW9ucyB9KTtcbiAgfSk7XG5cbiAgQVdTLm1vY2soJ0VMQnYyJywgJ2Rlc2NyaWJlTGlzdGVuZXJzJywgKF9wYXJhbXM6IGF3cy5FTEJ2Mi5EZXNjcmliZUxpc3RlbmVyc0lucHV0LCBjYjogQXdzQ2FsbGJhY2s8YXdzLkVMQnYyLkRlc2NyaWJlTGlzdGVuZXJzT3V0cHV0PikgPT4ge1xuICAgIGlmIChvcHRpb25zLmRlc2NyaWJlTGlzdGVuZXJzRXhwZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZXhwZWN0KF9wYXJhbXMpLnRvRXF1YWwob3B0aW9ucy5kZXNjcmliZUxpc3RlbmVyc0V4cGVjdGVkKTtcbiAgICB9XG4gICAgY2IobnVsbCwgeyBMaXN0ZW5lcnM6IG9wdGlvbnMubGlzdGVuZXJzIH0pO1xuICB9KTtcbn1cbiJdfQ==